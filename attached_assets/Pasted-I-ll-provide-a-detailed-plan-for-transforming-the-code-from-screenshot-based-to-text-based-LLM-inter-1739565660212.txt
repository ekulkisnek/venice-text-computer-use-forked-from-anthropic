I'll provide a detailed plan for transforming the code from screenshot-based to text-based LLM interaction, with specific checks at each stage.
Phase 1: Modify ComputerTool

    Remove Screenshot Components

- Remove gnome-screenshot dependency checks
- Remove _screenshot_delay property
- Remove screenshot-related methods

Checks:

    Verify no screenshot dependencies remain in imports
    Confirm screenshot methods are removed
    Test tool initialization without screenshot components

    Add Text Extraction Functions

- Implement page_content() method
- Add element_text() method for specific elements
- Create DOM query capabilities

Checks:

    Test page_content() returns complete page text
    Verify element_text() correctly targets specific elements
    Confirm DOM queries return expected results

    Implement DOM Selection

- Add element selection by ID/class/xpath
- Implement element attribute access
- Create element state tracking

Checks:

    Test element selection with various selectors
    Verify attribute access works correctly
    Confirm state tracking is accurate

Phase 2: Update ToolCollection

    Add Text Tools

- Create TextExtractionTool
- Implement PageContentTool
- Add ElementInteractionTool

Checks:

    Verify each tool registers correctly
    Test tool parameter validation
    Confirm tool execution returns expected results

    Update Tool Map

- Remove screenshot tool references
- Add new text-based tools to map
- Update tool initialization

Checks:

    Verify tool map contains only active tools
    Test tool lookup functionality
    Confirm tool collection serialization

Phase 3: Modify Streamlit Interface

    Remove Image Components

- Remove image rendering code
- Clean up image-related state
- Update UI layout

Checks:

    Verify no image components render
    Confirm state cleanup is complete
    Test UI responsiveness

    Add Text Display

- Implement text content areas
- Add DOM element highlighting
- Create interaction feedback display

Checks:

    Test text content rendering
    Verify highlighting works
    Confirm feedback is clear and accurate

Phase 4: Update Loop Logic

    Modify Sampling Loop

- Update message handling
- Implement text-based response processing
- Add tool result formatting

Checks:

    Test message flow
    Verify response processing
    Confirm result formatting

    Add State Management

- Implement text-based state tracking
- Add page context management
- Create navigation history

Checks:

    Test state persistence
    Verify context switches
    Confirm history tracking

Phase 5: New Features Implementation

    DOM Interaction

- Add element click simulation
- Implement form filling
- Create keyboard event simulation

Checks:

    Test element interactions
    Verify form submissions
    Confirm keyboard events

    Navigation

- Implement page navigation
- Add history tracking
- Create state preservation

Checks:

    Test navigation flow
    Verify history accuracy
    Confirm state preservation

Phase 6: System Prompt Updates

    Remove Screenshot References

- Update tool descriptions
- Modify capability descriptions
- Revise examples

Checks:

    Verify no screenshot mentions remain
    Test updated prompts
    Confirm example clarity

    Add Text Capabilities

- Document text extraction
- Add DOM interaction examples
- Include navigation guidelines

Checks:

    Test new capability descriptions
    Verify example completeness
    Confirm guideline clarity

Phase 7: Testing Suite

    Component Tests

- Test each tool individually
- Verify tool combinations
- Check error handling

Checks:

    Run individual tool tests
    Test tool interaction
    Verify error cases

    Integration Tests

- Test full interaction flow
- Verify state management
- Check performance metrics

Checks:

    Run full interaction tests
    Verify state consistency
    Monitor performance

Phase 8: Documentation

    Update API Documentation

- Document new methods
- Update tool descriptions
- Add usage examples

Checks:

    Verify documentation accuracy
    Test example code
    Confirm completeness

    User Guide Updates

- Update setup instructions
- Add troubleshooting guide
- Include best practices

Checks:

    Test setup process
    Verify troubleshooting steps
    Confirm guide clarity

I'll start implementing these changes when you're ready. Which phase would you like to begin with?